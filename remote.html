<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Remote Kamera (Realtime)</title>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <style>
    body{margin:0;font-family:Arial;background:#0b1220;color:#fff}
    header{padding:14px 16px;background:#111b33;font-weight:700}
    .wrap{padding:14px;max-width:520px;margin:auto}
    .card{background:#111b33;border-radius:14px;padding:12px;margin-top:12px}
    input,button{padding:12px 14px;border:0;border-radius:12px;width:100%}
    button{background:#2a5bff;color:#fff;font-weight:700;cursor:pointer}
    button.secondary{background:#2b3248}
    button.danger{background:#ff3b3b}
    .row{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .row button{flex:1;min-width:140px}
    .ok{color:#7CFF9C}
    .warn{color:#FFD966}
  </style>
</head>
<body>
  <header>üéÆ REMOTE KAMERA (Realtime)</header>

  <div class="wrap">
    <div class="card">
      <b>PIN Room</b>
      <input id="pin" placeholder="contoh: 1234" value="1234" />
      <div class="row">
        <button id="btnConnect">üîó CONNECT</button>
      </div>
      <div id="status" style="margin-top:8px;opacity:.9">Belum connect</div>
    </div>

    <div class="card">
      <div class="row">
        <button id="shot">üì∏ FOTO</button>
        <button id="sw" class="secondary">üîÅ SWITCH</button>
      </div>

      <div class="row">
        <button id="rec" class="danger">‚è∫Ô∏è REKAM</button>
        <button id="stop" class="secondary">‚èπÔ∏è STOP</button>
      </div>

      <div class="row">
        <button id="ton" class="secondary">üî¶ TORCH ON</button>
        <button id="toff" class="secondary">üî¶ TORCH OFF</button>
      </div>
    </div>
  </div>

<script>
  const firebaseConfig = {
    apiKey: "ISI_APIKEY_KAMU",
    authDomain: "ISI_AUTHDOMAIN_KAMU",
    databaseURL: "ISI_DATABASEURL_KAMU",
    projectId: "ISI_PROJECTID_KAMU",
    storageBucket: "ISI_STORAGEBUCKET_KAMU",
    messagingSenderId: "ISI_MESSAGINGSENDERID_KAMU",
    appId: "ISI_APPID_KAMU"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const pinEl = document.getElementById("pin");
  const statusEl = document.getElementById("status");

  let roomRef = null;

  function setStatus(html){
    statusEl.innerHTML = html;
  }

  function send(cmd){
    if(!roomRef) return alert("Connect dulu!");
    roomRef.child("cmd").set(cmd);
    roomRef.child("last_remote").set(Date.now());
  }

  document.getElementById("btnConnect").onclick = () => {
    const pin = pinEl.value.trim();
    if(!pin) return alert("Isi PIN dulu!");

    roomRef = db.ref("rooms/" + pin);

    roomRef.child("camera_online").on("value", (s) => {
      const online = s.val();
      if(online){
        setStatus(`‚úÖ Kamera ONLINE : <b class="ok">${pin}</b>`);
      }else{
        setStatus(`‚ö†Ô∏è Kamera OFFLINE / belum JOIN : <b class="warn">${pin}</b>`);
      }
    });
  };

  document.getElementById("shot").onclick = () => send("SHOT");
  document.getElementById("sw").onclick   = () => send("SWITCH");
  document.getElementById("rec").onclick  = () => send("REC_START");
  document.getElementById("stop").onclick = () => send("REC_STOP");
  document.getElementById("ton").onclick  = () => send("TORCH_ON");
  document.getElementById("toff").onclick = () => send("TORCH_OFF");
</script>
</body>
</html>