<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Remote Kamera (Realtime)</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
  body{margin:0;font-family:Arial;background:#0b1220;color:#fff}
  header{padding:14px 16px;background:#111b33;font-weight:700}
  .wrap{padding:14px;max-width:520px;margin:auto}
  .card{background:#111b33;border-radius:14px;padding:12px;margin-top:12px}
  input,button{padding:12px;border-radius:12px;border:0;width:100%;margin-top:8px}
  button{background:#2a5bff;color:#fff;font-weight:700;cursor:pointer}
  button.secondary{background:#2b3248}
  button.danger{background:#ff3b3b}
  .row{display:flex;gap:10px;flex-wrap:wrap}
  .row button{flex:1;min-width:140px}
  .ok{color:#7CFF9C}
</style>
</head>
<body>
<header>ğŸ® REMOTE KAMERA (Realtime)</header>

<div class="wrap">
  <div class="card">
    <b>PIN Room</b>
    <input id="pin" placeholder="contoh: 1234" value="1234"/>
    <button id="btnConnect">ğŸ”— CONNECT</button>
    <div id="status" style="margin-top:8px;opacity:.9"></div>
  </div>

  <div class="card">
    <div class="row">
      <button id="shot">ğŸ“¸ FOTO</button>
      <button id="sw" class="secondary">ğŸ” SWITCH</button>
    </div>

    <div class="row" style="margin-top:10px">
      <button id="rec" class="danger">âºï¸ REKAM</button>
      <button id="stop" class="secondary">â¹ï¸ STOP</button>
    </div>

    <div class="row" style="margin-top:10px">
      <button id="ton" class="secondary">ğŸ”¦ TORCH ON</button>
      <button id="toff" class="secondary">ğŸ”¦ TORCH OFF</button>
    </div>
  </div>
</div>

<script>
  // âœ… firebaseConfig dari project kamu
  const firebaseConfig = {
    apiKey: "AIzaSyBfNXj8JXz8hVMgQm2HY0YSyYv-aO75OAw",
    authDomain: "camera-3547b.firebaseapp.com",
    databaseURL: "https://camera-3547b-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "camera-3547b",
    storageBucket: "camera-3547b.appspot.com",
    messagingSenderId: "436520969909",
    appId: "1:436520969909:web:f4ab1cef0b53bbed7940fc"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  let roomRef = null;
  const statusEl = document.getElementById("status");

  function setStatus(html){ statusEl.innerHTML = html; }

  function send(cmd){
    if(!roomRef) return alert("Connect dulu!");
    roomRef.child("cmd").set(cmd);
    roomRef.child("last_remote").set(Date.now());
  }

  document.getElementById("btnConnect").onclick = () => {
    const pin = document.getElementById("pin").value.trim();
    if(!pin) return alert("Isi PIN dulu!");

    roomRef = db.ref("rooms/" + pin);

    setStatus(`âœ… Remote connect room: <span class="ok"><b>${pin}</b></span>`);

    roomRef.child("camera_online").on("value",(s)=>{
      const online = s.val();
      if(online) setStatus(`âœ… Kamera ONLINE: <span class="ok"><b>${pin}</b></span>`);
      else setStatus(`âš ï¸ Kamera OFFLINE / belum JOIN: <b>${pin}</b>`);
    });
  };

  document.getElementById("shot").onclick = ()=>send("SHOT");
  document.getElementById("sw").onclick   = ()=>send("SWITCH");
  document.getElementById("rec").onclick  = ()=>send("REC_START");
  document.getElementById("stop").onclick = ()=>send("REC_STOP");
  document.getElementById("ton").onclick  = ()=>send("TORCH_ON");
  document.getElementById("toff").onclick = ()=>send("TORCH_OFF");
</script>
</body>
</html>